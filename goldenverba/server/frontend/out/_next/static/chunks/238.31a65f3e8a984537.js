"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[238],{32238:(e,t,l)=>{l.r(t),l.d(t,{default:()=>m});var s=l(71729),a=l(43189),n=l(37839),r=l(20118),c=l(62130),i=l(21284),x=l(61717),o=l(69918);function u(e,t,l){return l===t?0:(e-t)/(l-t)}let d=[[0,128,0],[0,0,255],[255,0,0],[255,255,0],[128,0,128],[0,255,255],[255,165,0],[50,205,50],[255,192,203],[0,128,128],[148,0,211],[34,139,34],[255,215,0],[0,0,128],[255,0,255],[123,104,238]],m=e=>{let{credentials:t,selectedDocument:l,production:m,chunkScores:h}=e,[f,g]=(0,a.useState)(!1),[p,v]=(0,a.useState)([]),[b,j]=(0,a.useState)(""),[w,N]=(0,a.useState)(!1),[k,y]=(0,a.useState)(!0),[S,C]=(0,a.useState)(null),[_,M]=(0,a.useState)(200),[z,E]=(0,a.useState)(0),[A,D]=(0,a.useState)(null),[T,I]=(0,a.useState)(null),[H,P]=(0,a.useState)(-1),[V,q]=(0,a.useState)(1),[O,Q]=(0,a.useState)(-1),[X,Z]=(0,a.useState)(1),[B,F]=(0,a.useState)(-1),[G,J]=(0,a.useState)(1),K=(0,a.useCallback)(e=>({min:Math.min(...e),max:Math.max(...e)}),[]),L=(0,a.useCallback)(async()=>{if(A)try{let e=await (0,o.pQ)(A,b,t);e&&(""!==e.error?I(null):I(e.chunk))}catch(e){g(!1)}},[A,b,t]),R=(0,a.useCallback)(async()=>{try{g(!0);let e=await (0,o.u6)(l,w,t);if(e){if(""!==e.error)g(!1),v([]),E(0),j("None");else if(v(e.vector_groups.groups),j(e.vector_groups.embedder),E(e.vector_groups.dimensions),g(!1),!w&&e.vector_groups.groups.length>0){let t=e.vector_groups.groups[0];if((null==t?void 0:t.chunks)&&t.chunks.length>0){let e=t.chunks.map(e=>e.vector.x),l=t.chunks.map(e=>e.vector.y),s=t.chunks.map(e=>e.vector.z),{min:a,max:n}=K(e);P(a),q(n);let{min:r,max:c}=K(l);Q(r),Z(c);let{min:i,max:x}=K(s);F(i),J(x)}}}}catch(e){g(!1)}},[l,w,t,K]);(0,a.useEffect)(()=>{l?R():v([])},[l,R]),(0,a.useEffect)(()=>{A?L():I(null)},[A,L]);let U=(0,a.useMemo)(()=>{let e=[];return p.forEach((t,l)=>{t.chunks.forEach(s=>{e.push({uuid:s.uuid,chunk_id:s.chunk_id,documentTitle:t.name,vector:s.vector,groupIndex:l})})}),e},[p]),W=(0,a.useMemo)(()=>new Set((null!=h?h:[]).map(e=>e.uuid)),[h]),Y=(0,a.useMemo)(()=>[new r.A({id:"pc-layer",data:U,pickable:!0,pointSize:3,parameters:{depthTest:!0},getPosition:e=>[e.vector.x*_,e.vector.y*_,e.vector.z*_],getColor:e=>{if(W.has(e.uuid))return[255,255,0,255];if(A===e.uuid)return[0,255,0,255];if(k){let[t,l,s]=function(e,t,l,s,a,n,r){let c=u(e.x,t,l),i=u(e.y,s,a);return[Math.floor(255*u(e.z,n,r)),Math.floor(255*c),Math.floor(255*i)]}(e.vector,H,V,O,X,B,G);return[t,l,s,180]}let[t,l,s]=function(e){var t;return null!=(t=d[e%d.length])?t:[0,0,0]}(e.groupIndex);return[t,l,s,180]},onHover:e=>{let{object:t}=e;t?C("".concat(t.documentTitle," | ").concat(t.chunk_id)):C(null)},onClick:e=>{let{object:t}=e;t&&D(t.uuid)}})],[U,_,W,A,k,H,V,O,X,B,G]);return(0,s.jsxs)("div",{className:"flex h-full w-full flex-col gap-2",children:[(0,s.jsx)("div",{className:"flex w-full items-center justify-end gap-2",children:(0,s.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[f&&(0,s.jsx)("div",{className:"flex h-full items-center justify-center gap-2 text-text-alt-verba",children:(0,s.jsx)("span",{className:"loading loading-spinner loading-xs lg:loading-sm"})}),(0,s.jsx)("p",{className:"font-bold text-text-alt-verba text-xs lg:text-sm",children:"Embedding Model:"}),(0,s.jsx)("p",{className:"text-text-alt-verba text-xs lg:text-sm",children:b})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("p",{className:"font-bold text-text-alt-verba text-xs lg:text-sm",children:"Hover:"}),(0,s.jsx)("p",{className:"max-w-[100px] truncate text-text-alt-verba text-xs lg:max-w-[300px] lg:text-sm",title:null!=S?S:"",children:null!=S?S:""})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("p",{className:"font-bold text-text-alt-verba text-xs lg:text-sm",children:"Vectors:"}),(0,s.jsxs)("p",{className:"text-text-alt-verba text-xs lg:text-sm",children:[p.length," x ",(()=>{let e=0;for(let t of p)e+=t.chunks.length;return e})()," x ",z]})]})]}),(0,s.jsxs)("div",{className:"flex min-w-[20vw] items-center justify-between gap-10",children:[(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2",children:["Demo"!==m&&(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,s.jsx)("p",{className:"text-text-alt-verba text-xs",children:"Show All Documents"}),(0,s.jsx)("input",{checked:w,className:"toggle",onChange:e=>{N(e.target.checked)},type:"checkbox"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,s.jsx)("p",{className:"text-text-alt-verba text-xs",children:"Dynamic Coloring"}),(0,s.jsx)("input",{checked:k,className:"toggle",onChange:e=>{y(e.target.checked)},type:"checkbox"})]})]}),(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,s.jsxs)("div",{className:"dropdown dropdown-bottom flex w-full items-center justify-start",children:[(0,s.jsxs)("button",{type:"button",className:"btn btn-sm flex w-full justify-start border-none bg-button-verba text-text-verba hover:bg-button-hover-verba",disabled:!0,tabIndex:0,children:[(0,s.jsx)(i.T6S,{size:15}),(0,s.jsx)("p",{children:"PCA"})]}),(0,s.jsx)("ul",{className:"dropdown-content menu z-[1] w-full rounded-box bg-base-100 p-2 shadow"})]}),(0,s.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,s.jsx)("p",{className:"text-sm text-text-alt-verba",children:"Zoom"}),(0,s.jsx)("input",{className:"range range-xs w-full grow",max:"1000",min:0,onChange:e=>{M(Number(e.target.value))},type:"range",value:_})]})]}),T&&(0,s.jsx)("button",{type:"button",className:"btn btn-square flex gap-2 border-none bg-button-verba text-text-verba hover:bg-warning-verba",onClick:()=>{I(null),D(null)},children:(0,s.jsx)(x.uDv,{size:15})})]})]})}),(0,s.jsxs)("div",{className:"flex h-[45vh] w-full gap-5",children:[(0,s.jsx)("div",{className:"flex flex-grow transition-all duration-300 ease-in-out ".concat(A?"w-2/3":"w-full"," h-full"),children:(0,s.jsx)(n.A,{views:[new c.A],controller:!0,initialViewState:{target:[0,0,0],rotationX:0,rotationOrbit:0,zoom:.5},layers:Y,style:{width:"100%",height:"100%"}})}),(0,s.jsx)("div",{className:"flex flex-grow transition-all duration-300 ease-in-out ".concat(A?"w-1/3 opacity-100":"w-0 opacity-0"," overflow-auto"),children:T&&(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2 p-3",children:[(0,s.jsxs)("p",{className:"fond-bold text-text-alt-verba",children:["Chunk ",T.chunk_id]}),(0,s.jsx)("p",{className:"text-sm text-text-alt-verba",children:T.content})]})})]})]})}}}]);